# 🏋️ ЗОЖник — Telegram бот для здоровых привычек

> 💚 Персональный ассистент по здоровым привычкам прямо в Telegram
> Вода, активность, сон — всё в одном месте!

**Учебный проект** • [Установка](#-установка-и-запуск) • [Возможности](#-возможности)

---

## 🌟 Основные возможности

### 💧 Водный трекер
- ✅ Установка дневной цели (1.5л, 2л, 2.5л, 3л или свободный ввод: 500–8000 мл)
- ✅ **Автоматический еженедельный сброс† статистики** с учётом часового пояса
- ✅ **Полное логирование** добавлений воды (защита от потери данных при сбоях)
- ✅ Гибкие напоминания:
  - ⏰ **По интервалу** (каждые 1–5 часов)
  - 🤖 **Умный режим** (напомнит, если не пил 3+ часа)
- ✅ Быстрые кнопки (250, 330, 450, 750, 1000 мл) + ручной ввод
- ✅ Прогресс-бар с мотивационными сообщениями
- ✅ Защита от спама (минимум 15 минут между записями)
- ✅ Безопасные лимиты: 5л (разумный), 8л (жесткий)

### 💪 Трекер физической активности
- ✅ Расширенная библиотека упражнений с фильтрацией:
  - 6 категорий (Силовые, Кардио, Растяжка, Ходьба, Зарядка, Баланс)
  - 3 уровня сложности (Новичок, Средний, Продвинутый)
- ✅ **Видео-демонстрация упражнений** (опционально)
  - Кнопка "⏭️ Пропустить видео" при добавлении
  - Кнопка "📹 Открыть видео" только если видео прикреплено
- ✅ Избранные упражнения и пагинированные списки
- ✅ Статистика выполнения:
  - Всего выполнений
  - За текущую неделю
  - ТОП-5 популярных упражнений
- ✅ Умные лимиты времент между выполнениями:
  - Одно упражнение: не чаще раза в 15 минут
  - Разные упражнения: не чаще раза в 5 минут
- ✅ Админ-панель для управления упражнениями:
  - Добавление нового упражнения (видео необязательно)
  - Редактирование параметров
  - Удаление с подтверждением
  - Включение/выключение статуса

### 📊 Статистика пользователя
- ✅ **Одна кнопка в главном меню** для быстрого доступа
- ✅ Отображает:
  - 👤 Никнейм и дата регистрации
  - 💧 Прогресс по воде (цель, выпито сегодня / за неделю)
  - 💪 Прогресс по упражнениям (цель, выполнено сегодня / за неделю)
  - Визуальные прогресс-бары для каждого п трекера
- ✅ Показывает "Не настроено" для отключённых трекеров
- ✅ Закрывается кнопкой "⬅️ Закрыть"

### 👨‍⚕️ Система обращений (тикеты)
- ✅ Категории: Техподдержка и Персональные консультации
- ✅ Создание с заголовком (макс. 50 символов) и описанием
- ✅ Диалог с администраторой в чате
- ✅ Статусы обращений: 🆕 новые, ✅ прочитанные
- ✅ Пагинация (по 10 тикетов на странице)
- ✅ Подтверждение удаления
- ✅ Примечание фото в обращение

### ⚙️ Настройки пользователя
- ✅ Выбор часового пояса (Россия: МСК-1 … МСК+9)
- ✅ Раздельные настройки для каждого трекера:
  - Дневная цель
  - Тип напоминаний
  - Интервал уведомлений
- ✅ Обновления целей в любой момент

### 🛠️ Админ-панель
- ✅ **Статистика пользователей**:
  - Всего пользователей
  - Активные за 4 дня
  - Новые за день/неделю
  - Распределение по трекерам
- ✅ **Массовая рассылка** с предпросмотром
- ✅ **Управление администраторами** (добавить/удалить по ID или username)
- ✅ **Автоматическая цензура**:
  - Словарь оскорблений (RU/EN/транслит)
  - Опциональная AI-проверка (Detoxify)
  - Автоматическое снятие прав при нарушении
- ✅ **Просмотр и ответы** на обращения пользователей
- ✅ **Управление упражнениями**:
  - Добавление новых (видео опционально)
  - Редактирование и удаление
  - Просмотр статистики выполнений

---

## 📋 Требования

```
Python  3.11+
```

### Зависимости

```
pyTelegramBotAPI>=4.29.1
detoxify>=0.5.2
python-dotenv>=1.2.1
aiosqlite>=0.19.0
aiohttp>=3.9.0
```

---

## 🚀 Установка и запуск

### 1️⃣ Клонирование

```bash
git clone https://github.com/твой-юзербейм/zozhnik-bot.git
cd zozhnik-bot
```

### 2️⃣ Виртуальное окружение

```bash
python -m venv .venv

# Windows:
.venv\Scripts\activate

# Linux/macOS:
source .venv/bin/activate
```

### 3️⃣ Зависимости

```bash
pip install -r requirements.txt
```

### 4️⃣ Владельцы бота (обязательно)

Создай файл `owners.json` в корне проекта:

```json
[
  6295868318,
  123456789
]
```

> 📝 **Где взять ID?** Напиши [@userinfobot](https://t.me/userinfobot) в Telegram

### 5️⃣ Переменные окружения

Создай файл `.env`:

```env
token_bot=YOUR_TELEGRAM_TOKEN_HERE
```

> 🔑 **Получить токен:** Напиши [@BotFather](https://t.me/BotFather) → /newbot

### 6️⃣ Запуск

```bash
python main.py
```

✅ **Готово!** Бот работает и готов к использованию

---

## 🏗️ Архитектура

```
bot/
├── main.py                    # Точка входа и обработчики callback'ов
├── config.py                  # Конфиг (настройка)
├── database.py                # Все операции с SQLite
├── keyboards.py               # Инлайн и текстовые клавиатуры
├── messages.py                # Все сообщения пользователям
│
├── handlers/
│   ├── water.py              # Логика водного трекера
│   ├── sports/
│   │   ├── admin_exercises.py  # Управление упражнениями
│   │   └── user_exercises.py   # Просмотр и выполнение упражнений
│   ├── settings.py           # Настройки пользователя
│   ├── stats.py              # Статистика
│   ├── broadcast.py          # Рассылки
│   ├── owner_menu.py         # Управление админами
│   ├── admin_notifications.py # Уведомления администрации
│   ├── sleeps.py             # Заглушка трекера сна
│   └── support/
│       ├── support.py        # Обработка тикетов
│       └── ticket_sorting.py # Сортировка обращений
│
├── utils/
│   ├── fsm.py                # State Machine для многошаговых диалогов
│   ├── scheduler.py          # Фоновый планировщик (напоминания)
│   ├── antispam.py           # Защита от мультимедиа-спама
│   ├── rate_limit_send.py    # Ограничения на отправку
│   └── censorship/
│       ├── checker.py        # Проверка цензуры
│       └── word_filter.py    # Словарь для фильтрации
│
├── database.db               # SQLite база
├── owners.json               # ID владельцев
└── requirements.txt          # Зависимости
```

---

## 🧪 Технологический стек

| Компонент | Технология |
|-----------|------------|
| **Язык** | Python 3.11+ |
| **Telegram API** | pyTelegramBotAPI (AsyncTeleBot) |
| **База данных** | SQLite + aiosqlite |
| **Асинхронность** | asyncio |
| **AI-цензура** | Detoxify (опционально) |
| **Конфиги** | python-dotenv, JSON |
| **Контроль версий** | Git |

---

## ✅ Текущий статус

### Готово
- ✅ Полный цикл водного трекера с логированием
- ✅ Еженедельный автоматический сброс статистики
- ✅ Система обращений (тикеты) пользователь ↔ админ
- ✅ Админ-панель с рассылками и статистикой
- ✅ Управление администраторами
- ✅ Цензура (словарная + AI опционально)
- ✅ Полностью асинхронный код
- ✅ Собственная FSM для многошаговых диалогов
- ✅ Фоновый планировщик для напоминаний
- ✅ Трекер физической активности с видео
- ✅ Статистика пользователя

### В разработке
- 🔄 Трекер сна (базовая структура готова)
- 🔄 Расширенная статистика и графики
- 🔄 ИИ Аналитика и советы пользователям
- 🔄 Docker-контейнеризация

---

## 📝 Лицензия

MIT License — используй свободно в образовательных целях

---

## 👨‍💻 Автор

Создано как учебный проект для демонстрации:
- Работы с Telegram Bot API
- Асинхронного программирования на Python
- Проектирования баз данных
- Разработки многошаговых диалогов
- Организации первого большого проекта

---


**Спасибо за внимание!** ✨
